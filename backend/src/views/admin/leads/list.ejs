<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %> - Admin Panelsss
    </title>
    <link rel="stylesheet" href="/css/admin.css">
</head>

<body>
    <div class="admin-wrapper">
        <%- include('../../partials/sidebar') %>

            <main class="main-content">
                <header class="top-header">
                    <h1>
                        <%= title %>
                    </h1>
                    <div class="user-info">
                        <span>Welcome, <%= userName %></span>
                    </div>
                </header>

                <% if (error && error.length> 0) { %>
                    <div class="alert alert-error">
                        <%= error %>
                    </div>
                    <% } %>

                        <% if (success && success.length> 0) { %>
                            <div class="alert alert-success">
                                <%= success %>
                            </div>
                            <% } %>

                                <div class="content">
                                    <div class="table-header">
                                        <h2>All Leads (<%= totalLeads %>)</h2>
                                    </div>

                                    <div class="table-container">
                                        <table class="data-table">
                                            <thead>
                                                <tr>
                                                    <th>Name</th>
                                                    <th>Email</th>
                                                    <th>Phone</th>
                                                    <th>Type</th>
                                                    <th>Status</th>
                                                    <th>Created At</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if (leads.length===0) { %>
                                                    <tr>
                                                        <td colspan="6" style="text-align: center;">No leads found</td>
                                                    </tr>
                                                    <% } else { %>
                                                        <% leads.forEach(lead=> { %>
                                                            <tr>
                                                                <td>
                                                                    <%= lead.name %>
                                                                </td>
                                                                <td>
                                                                    <%= lead.email %>
                                                                </td>
                                                                <td>
                                                                    <%= lead.phone %>
                                                                </td>
                                                                <td>
                                                                    <span class="badge badge-type">
                                                                        <%= lead.leadType %>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <span class="badge badge-<%= lead.status %>">
                                                                        <%= lead.status.replace('_', ' ' ).toUpperCase()
                                                                            %>
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    <%= new Date(lead.createdAt).toLocaleDateString() %>
                                                                </td>
                                                            </tr>
                                                            <% }) %>
                                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>

                                    <% if (totalPages> 1) { %>
                                        <div class="pagination">
                                            <% if (currentPage> 1) { %>
                                                <a href="/admin/leads?page=<%= currentPage - 1 %>"
                                                    class="page-link">Previous</a>
                                                <% } %>

                                                    <% for (let i=1; i <=totalPages; i++) { %>
                                                        <% if (i===currentPage) { %>
                                                            <span class="page-link active">
                                                                <%= i %>
                                                            </span>
                                                            <% } else if (i===1 || i===totalPages || (i>= currentPage -
                                                                2 && i <= currentPage + 2)) { %>
                                                                    <a href="/admin/leads?page=<%= i %>"
                                                                        class="page-link">
                                                                        <%= i %>
                                                                    </a>
                                                                    <% } else if (i===currentPage - 3 || i===currentPage
                                                                        + 3) { %>
                                                                        <span class="page-link">...</span>
                                                                        <% } %>
                                                                            <% } %>

                                                                                <% if (currentPage < totalPages) { %>
                                                                                    <a href="/admin/leads?page=<%= currentPage + 1 %>"
                                                                                        class="page-link">Next</a>
                                                                                    <% } %>
                                        </div>
                                        <% } %>
                                </div>
            </main>
    </div>
</body>

</html>